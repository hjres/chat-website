<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Ø§Ù„Ø´Ø§Øª</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f0f0;
      margin: 0;
      padding: 0;
    }
    .container {
      width: 90%;
      margin: auto;
      padding-top: 20px;
    }
    #messages {
      background: #fff;
      border: 1px solid #ccc;
      padding: 10px;
      height: 300px;
      overflow-y: scroll;
      margin-bottom: 10px;
    }
    #messageInput {
      width: 80%;
      padding: 10px;
    }
    #sendBtn {
      padding: 10px;
    }
    #admin-panel {
      display: none;
      background: #dff0d8;
      padding: 10px;
      margin-bottom: 20px;
      border: 1px solid #3c763d;
    }
    #settings {
      margin-top: 20px;
    }
    .hidden {
      display: none;
    }
    #auth-container {
      margin: auto;
      padding: 20px;
      background: #fff;
      border-radius: 8px;
      max-width: 400px;
      text-align: center;
      margin-top: 50px;
    }
    input {
      width: 90%;
      padding: 10px;
      margin: 10px 0;
      font-size: 16px;
    }
    button {
      padding: 10px 20px;
      margin: 5px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>

<body>

<div id="auth-container" class="container hidden">
  <h2>ØªØ³Ø¬ÙŠÙ„ Ø¹Ø¶ÙˆÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©</h2>
  <input type="text" id="registerUsername" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
  <input type="password" id="registerPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
  <button onclick="register()">ØªØ³Ø¬ÙŠÙ„ Ø¹Ø¶ÙˆÙŠØ©</button>

  <hr>

  <h2>Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</h2>
  <input type="text" id="loginUsername" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
  <input type="password" id="loginPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
  <button onclick="login()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</button>

  <hr>

  <h2>Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø²Ø§Ø¦Ø±ÙŠÙ†</h2>
  <button onclick="guestLogin()">Ø¯Ø®ÙˆÙ„ ÙƒØ²Ø§Ø¦Ø±</button>
</div>

<div class="container hidden" id="chat-container">
  <!-- Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø£Ø¯Ù…Ù† -->
  <div id="admin-panel">
    <h2>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¯ÙŠØ±</h2>
    <button onclick="manageUsers()">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</button>
    <button onclick="manageMessages()">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„</button>
    <button onclick="viewReports()">Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª</button>
  </div>

  <!-- ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ -->
  <div id="messages"></div>

  <!-- ÙƒØªØ§Ø¨Ø© Ø±Ø³Ø§Ù„Ø© -->
  <input type="text" id="messageInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§">
  <button id="sendBtn" onclick="sendMessage()">Ø¥Ø±Ø³Ø§Ù„</button>

  <!-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
  <div id="settings">
    <h3>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©</h3>
    <button onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
  </div>
</div>

<!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ -->
<div id="profilePopup" style="display:none; position:fixed; top:20%; left:50%; transform:translateX(-50%); background:white; padding:20px; border-radius:10px; box-shadow:0 0 10px gray;">
  <img id="profileImage" src="" style="width:80px; height:80px; border-radius:50%;"><br><br>
  <strong id="profileName"></strong><br><br>
  <button onclick="startPrivateChat()">Ù…Ø±Ø§Ø³Ù„Ø© Ø®Ø§ØµØ©</button>
  <button onclick="reportUser()">Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</button><br><br>
  <button onclick="closeProfile()">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<input type="file" id="uploadImage" accept="image/*" onchange="previewImage()" style="display:none;">
<label for="uploadImage" style="cursor:pointer;">ğŸ“· Ø±ÙØ¹ ØµÙˆØ±Ø©</label>
<div id="uploadedImagePreview"></div>

<script>
  // Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙˆØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
  function register() {
    var username = document.getElementById('registerUsername').value.trim();
    var password = document.getElementById('registerPassword').value.trim();
    if (!username || !password) {
      alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±');
      return;
    }
    var users = JSON.parse(localStorage.getItem('users')) || [];
    var exists = users.find(u => u.username === username);
    if (exists) {
      alert('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙØ¹Ù„');
      return;
    }
    users.push({ username: username, password: password });
    localStorage.setItem('users', JSON.stringify(users));
    localStorage.setItem('currentUser', username);
    alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¹Ø¶ÙˆÙŠØ© Ø¨Ù†Ø¬Ø§Ø­');
    loadChat();
  }

  function login() {
    var username = document.getElementById('loginUsername').value.trim();
    var password = document.getElementById('loginPassword').value.trim();
    var users = JSON.parse(localStorage.getItem('users')) || [];
    var user = users.find(u => u.username === username && u.password === password);
    if (user) {
      localStorage.setItem('currentUser', username);
      loadChat();
    } else {
      alert('Ø®Ø·Ø£ ÙÙŠ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±');
    }
  }

  function guestLogin() {
    var guestName = prompt("Ø§Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ ÙƒØ²Ø§Ø¦Ø±:");
    if (guestName) {
      localStorage.setItem('currentUser', "Ø²Ø§Ø¦Ø± - " + guestName);
      loadChat();
    }
  }

  function loadChat() {
    document.getElementById('auth-container').classList.add('hidden');
    document.getElementById('chat-container').classList.remove('hidden');

    var username = localStorage.getItem('currentUser');
    if (username === "admin") {
      document.getElementById('admin-panel').style.display = 'block';
    }
  }

  // Ø¯Ø§Ù„Ø© Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©
  function sendMessage() {
    var messageBox = document.getElementById('messages');
    var input = document.getElementById('messageInput');
    if (input.value.trim() !== '') {
      var message = document.createElement('div');
      message.textContent = localStorage.getItem('currentUser') + ": " + input.value;
      messageBox.appendChild(message);
      input.value = '';
      messageBox.scrollTop = messageBox.scrollHeight;
    }
  }

  // Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
  function logout() {
    localStorage.removeItem('currentUser');
    window.location.reload();
  }

  // Ø¯ÙˆØ§Ù„ Ø£Ø®Ø±Ù‰
  function manageUsers() {
    alert('Ù‡Ø°Ù‡ ØµÙØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ (Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±)');
  }

  function manageMessages() {
    alert('Ù‡Ø°Ù‡ ØµÙØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ (Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±)');
  }

  function viewReports() {
    alert('Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª (Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±)');
  }

  function startPrivateChat() {
    alert('Ø¨Ø¯Ø¡ Ù…Ø­Ø§Ø¯Ø«Ø© Ø®Ø§ØµØ© (Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±)');
  }

  function reportUser() {
    alert('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù„Ø§Øº Ø¥Ù„Ù‰ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©');
  }

  function closeProfile() {
    document.getElementById('profilePopup').style.display = 'none';
  }

  function previewImage() {
    var file = document.getElementById('uploadImage').files[0];
    if (file) {
      var reader = new FileReader();
      reader.onload = function(e) {
        document.getElementById('uploadedImagePreview').innerHTML = '<img src="'+e.target.result+'" style="width:100px;height:100px;border-radius:50%;">';
      }
      reader.readAsDataURL(file);
    }
  }

  // Ø§Ù„ØªØ­Ù‚Ù‚ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
  window.onload = function() {
    var username = localStorage.getItem('currentUser');
    if (username) {
      loadChat();
    } else {
      document.getElementById('auth-container').classList.remove('hidden');
    }
  };
</script>

</body>
</html>
